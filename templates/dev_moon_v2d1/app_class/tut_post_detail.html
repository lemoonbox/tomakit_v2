{% extends 'base.html' %}
{% load static from staticfiles%}
{% load humanize %}
{% load v2d1_board_tags %}
<title>{%block title%}토마킷 {{post.title}}{%endblock%}</title>
{%block style%}
<style>
    body {background-color:#fff!important;}
    /*img {max-width:100%;}*/
    /* Star Rating */
    .starRating,
    .starRating span {
        display: inline-block;
        /*height: 14px;*/
        background: transparent url({%static 'media/image/slice/icon-star_fill.png'%}) no-repeat;
        overflow: hidden;
    }
    .starRating {
        width: 79px;
        vertical-align: middle;
    }
    .starRating span {
        font-size: 0;
        line-height: 0;
        vertical-align: top;
        text-indent: -100px;
        *text-indent: 0;
        background-position: 0 -14px;
    }
    /*.tmk-class-pay img {max-width:100px;}*/
    .tmk-class-pay {border:1px solid #ddd;border-radius:4px;}
    .tmk-class-pay-top {padding:10px;}
    .tmk-class-pay .tmk-h3 {border-bottom:1px solid #ddd;padding:15px;margin-top:0px;}
    .tmk-class-pay label {line-height:36px;color:#82888A;font-size:14px;font-weight:normal;width:35%;vertical-align:middle;}
    .col-md-12 img {max-width:100px;}
    .tmk-infobox-price {height:120px; line-height:24px;text-align:left;background-color:#eee;padding:10px;}
    .tmk-infobox-price div {float:left;width:50%;}
    .tmk-infobox-price label {line-height:18px;}
    .tmk-infobox-profile{float:left;width:100%;text-align:left;padding:10px;}
    .tmk-infobox-profile .img-grid {width:30%;float:left;overflow:hidden;vertical-align:middle;}
    .tmk-infobox-profile .infobox-img-wrapper {border-radius:50%;width:55px;height:55px;overflow:hidden;}
    .tmk-infobox-profile .infobox-img-wrapper img {width:150%;position:center;}
    /*.tmk-infobox-price*/
    .tmk-infobox-profile div {width:60%;float:left;}
    .tmk-infobox-profile label {width:60%;line-height:20px;}
    .tmk-infobox-profile .h3 {margin:0px;padding:0;}
    .tmk-main-body {font-size:18px;line-height:28px;}
</style>
{%endblock%}
<body>
{%block content%}
<!--맞춤 수업 상세 페이지-->
<div class="tmk-main-body col-md-12">
    <div class="container">
        <div class="tmk-page-header col-md-12">
            <div class="tmk-h4">{{post.category.category|cate2han}}</div>
            <div class="tmk-h2 tmk-title">{{post.title}}</div>
            <div class="tmk-h4">{{post.intro_line}}</div>
            <span class="label tmk-label">즉시 등록 수업</span>
        </div>

        <!--사진-->
        <div class="col-md-12">
            <div id="class-post-Carousel" class="carousel slide" data-ride="carousel">
                <!--Indicators -->
                <ol class="carousel-indicators">
                    {% for image in post.t2classpic_set.all%}{% if forloop.counter0 == 0 %}
                    <li data-target="#class-post-Carousel" data-slide-to="{{forloop.counter0}}" class="active"></li>
                    {% else %}
                    <li data-target="#class-post-Carousel" data-slide-to="{{forloop.counter0}}"></li>
                    {% endif %} {%endfor%}
                </ol>
                <!-- Wrapper for slides -->
                <div class="carousel-inner" role="listbox">
                    {% for image in post.t2classpic_set.all%} {% if forloop.counter0 == 0 %}
                    <div class="item active">
                        <img src="{{MEDIA_URL}}{{image.image}}" alt="{{post.title}} image{{forloop.counter0}}">
                    </div>
                    {% else %}
                    <div class="item">
                        <img src="{{MEDIA_URL}}{{image.image}}" alt="{{post.title}} image{{forloop.counter0}}">
                    </div>
                    {% endif %}{%endfor%}
                </div>
                <!-- Left and right controls -->
                <a class="left carousel-control" href="#class-post-Carousel" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#class-post-Carousel" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>


        <div class="col-md-8">
            <div class="tmk-h3" style="font-weight:bold;">클래스 소개</div>
            <!--동영상-->
            {% if post.video%}
            <iframe width="100%" height="600px" src="https://www.youtube.com/embed/{{post.video}}" frameborder="0" allowfullscreen></iframe>
            {% endif %}
            소개
            {{post.descript}}
            커맄큘럼
            {{post.curri}}
            안내사항
            {{post.notic}}
            공방위치
            {{post.addr}}

            <div class="tmk-h3" style="font-weight:bold;">선생님 소개</div>
            <a href="http://{{HTTP_HOST}}/v2.1/user/profile/{{post.user.id}}">
                <img src="{{MEDIA_URL}}{{post.user.t2profile_set.first.pro_pic}}">
                {{post.user.last_name}}{{post.user.first_name}}</a>
            {{post.user.t2hostprofile_set.first.intro_self}}
        </div>
        <div class="col-md-4">
            <div class="tmk-class-pay">
               <div class="tmk-class-pay-top">
                   <!--<div class=h3>수업정보</>-->
                <div class="tmk-h3" style="font-weight:bold;">{{post.repeat}}회 과정 / 총 {% widthratio post.repeat 1 post.perhour%}시간</div>
                <div style="text-align:left;">
                    <div>
                        <label><img src="{%static 'media/image/slice/icon-intro_time.png'%}"> 모집 마감일</label> 즉시 등록 수업
                    </div>
                    <div>
                        <label><img src="{%static 'media/image/slice/icon-intro_flag.png'%}"> 수업 시작일 </label> 날짜 협의
                    </div>
                    <div>
                        <label><img src="{%static 'media/image/slice/icon-intro_clock.png'%}"> 수업 일정</label> {{post.weekday}}
                    </div>
                    <div>
                        <label><img src="{%static 'media/image/slice/icon-intro_people.png'%}"> 인원</label> 소수 맞춤수업
                        {%comment%}최소{{post.min_num}}명~최대{{post.max_num}}명{%endcomment%}
                    </div>
                    <div>
                        <label><img src="{%static 'media/image/slice/icon-intro_location.png'%}"> 장소</label> {{post.addr}}
                    </div>
                </div>
               </div>
                <div class="tmk-infobox-price">
                    <div><label>재료비</label><br>
                        {{post.extra_price|intcomma}}<br>
                        <label>수강료</label><br>
                        {{post.price|intcomma}}</div>
                    <div>합계 {{ post.extra_price|add:post.price |intcomma}}</div>
                </div>
                <!--강사 프로필-->
                <div class="tmk-infobox-profile">
                    <a href="http://{{HTTP_HOST}}/v2.1/user/profile/{{post.user.id}}">
                        <div class="img-grid">
                            <div class="infobox-img-wrapper">
                                <img src="{{MEDIA_URL}}{{post.user.t2profile_set.first.pro_pic}}">
                            </div>
                        </div>
                        <div>
                            <label>클래스 선생님</label><br>
                            <div class="h3">{{post.user.last_name}}{{post.user.first_name}}</div>
                        </div>
                    </a>
                </div>

                <div style="padding:10px;">
                <!-- 결제 하기 -->
                <form method="GET" action="{% url 'pay_prefill_v2d1' %}">
                    <input type="hidden" value="{{post.id}}" name="post_id">
                    <input type="hidden" value="tutclass" name="classtype">
                    <button class="btn btn-primary btn-block">
                        신청하기 <input type="submit" value="{{ post.extra_price|add:post.price |intcomma}}원" hidden>
                    </button>
                </form>
                    </div>
            </div>
        </div>
    </div>
</div>

<div class="tmk-main-body col-md-12" style="box-shadow:0 1px 4px rgba(0,0,0,0.25)!important">
    <div class="container">
        <div class="col-md-8">
            <div class="tmk-h3" style="font-weight:bold;">후기 쓰기</div>

            <form method="POST" action="{% url 'create_review_v2d1' post.id %}">
                {%csrf_token%}
                <input type="hidden" name="class_num" value="{{post.id}}">
                <input type="hidden" name="classtype" value="tut_class">
                <textarea name="review"></textarea>
                {{review.review.errors|striptags}}
                <input type="number" name="grade" min="1" max="5">
                {{review.grade.errors|striptags}}
                <input type="submit" value="후기입력">
            </form>
            {% for review in post.t2classreview_set.all%}
            {% if review.is_active %}
            <a href="http://{{HTTP_HOST}}/v2.1/user/profile/{{review.user.id}}">
                <img src="{{MEDIA_URL}}{{review.user.t2profile_set.first.pro_pic}}">
                {{review.user.last_name}}{{review.user.first_name}}</a>
            후기: {{review.review}}
            <!--//등급::-->
            <div>
                {{review.grade}}
                <p>

            <span class="starRating">
        <span>{{review.grade}}</span>
                </span>
                </p>


            </div>

            <!--수정 form 나중에  hidden-->
            <form method="POST" action="{% url 'modify_review_v2d1' post.id %}">
                {%csrf_token%}
                <input type="hidden" name="review_num" value="{{review.id}}">
                <input type="hidden" name="class_num" value="{{post.id}}">
                <input type="hidden" name="classtype" value="tut_class">
                <textarea name="review">{{review.review}}</textarea>
                <input type="number" name="grade" value="{{review.grade}}">
                <input type="submit" value="후기수정">
            </form>
            <form method="POST" action="{% url 'delete_review_v2d1' review.id%}">
                {%csrf_token%}
                <input type="hidden" name="classtype" value="tut_class">
                <input type="submit" value="삭제하기">
            </form>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<div class="tmk-main-body col-md-12" style="background:#eee;height:260px;margin-top:3px;margin-bottom:-50px;">
    <div style="margin:50px auto;">
        <div class="tmk-h3" style="font-weight:bold;">원하는 클래스를 찾지 못했나요?</div>
        <div class="tmk-h4">클래스를 제안해보세요 원하시는 클래스를 개설해드린답니다</div>
        <a href="http://{{HTTP_HOST}}/v2.1/demand/create" class="btn btn-link" style="color:red;">클래스 제안하기 ></a>

    </div>
</div>
{%endblock%}
{%block script%}
<script src="http://code.jquery.com/jquery-latest.js"></script>
{%endblock%}