{% extends 'base.html'%}
{% load static from staticfiles %}
{% load humanize %}
{% load v2d1_board_tags %}
<title>{%block title%}Tomakit {{post.title}}{%endblock%}</title>
{%block style%}
<style>
body {background-color:#fff!important;}
    .html5-video-content {width:100%!important;}
.col-md-12 img {max-width:100px;}
</style>

{%endblock%}

<body>
{%block content%}

<br>
<!--워크샵 수업 상세 페이지-->

<div class="tmk-main-body col-md-12">
    <div class="container">
        <div class="tmk-page-header col-md-12">
        <div class="tmk-h4">{{post.category.category|cate2han}}</div>
        <div class="tmk-h2 tmk-title">{{post.title}}</div>
        <div class="tmk-h4">{{post.intro_line}}</div>
        <span class="label tmk-label">D-{{post.deadline|d_day_count}}</span>
    </div>
    <!--<div class="tmk-page-pick col-md-12"></div>-->
    <div class="col-md-12">
        <div id="class-post-Carousel" class="carousel slide" data-ride="carousel">
            <!--Indicators -->
            <ol class="carousel-indicators">
                {% for image in post.t2classpic_set.all%}{% if forloop.counter0 == 0 %}
                <li data-target="#class-post-Carousel" data-slide-to="{{forloop.counter0}}" class="active"></li>
                {% else %}
                <li data-target="#class-post-Carousel" data-slide-to="{{forloop.counter0}}"></li>
                {% endif %} {%endfor%}
            </ol>
            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox">
                {% for image in post.t2classpic_set.all%} {% if forloop.counter0 == 0 %}
                <div class="item active">
                    <img src="{{MEDIA_URL}}{{image.image}}" alt="{{post.title}} image{{forloop.counter0}}">
                </div>
                {% else %}
                <div class="item">
                    <img src="{{MEDIA_URL}}{{image.image}}" alt="{{post.title}} image{{forloop.counter0}}">
                </div>
                {% endif %}{%endfor%}
            </div>
            <!-- Left and right controls -->
            <a class="left carousel-control" href="#class-post-Carousel" role="button" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#class-post-Carousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>

    <div class="tmk-post-body">
        <div class="col-md-8">
            <div class="tmk-h3" style="font-weight:bold;">클래스 소개</div>>

            <h3>클래스 소개</h3>
            <!--동영상-->

            {% if post.video%}
            <iframe width="100%" height="600px" src="https://www.youtube.com/embed/{{post.video}}" frameborder="0" allowfullscreen></iframe>
            {% endif %}
            소개<br>
            {{post.descript}}<br>
            커맄큘럼<br>
            {{post.curri}}<br>
            안내사항<br>
            {{post.notic}}<br>

            공방위치<br>
            {{post.addr}}<br><br>

            <h3>선생님 소개</h3>
            <a href="http://{{HTTP_HOST}}/v2.1/profile/{{post.user.id}}">
            <img src="{{MEDIA_URL}}{{post.user.t2profile_set.first.pro_pic}}"><br>
            {{post.user.last_name}}{{post.user.first_name}}</a><br>
            {{post.user.t2hostprofile_set.first.intro_self}}<br>
            <br>

</div>
        </div>
    <div class="col-md-4 tmk-class-pay">
        <!--<h3>수업정보</h3>-->
        <div class="h3">{{post.repeat}}회 과정/{% widthratio post.repeat 1 post.perhour%}시간</div>
        <label>모집 마감일</label> {{post.deadline|date:"Y년 n월 d"}}
        <label>수업 시작일 </label> {{post.startday|date:"Y년 n월 d"}}
        <label>수업 일정</label> {{post.weekday}}
        <label>수업 인원</label> 최소{{post.min_num}}명~최대{{post.max_num}}명
        <label>장소</label> {{post.addr}}
        <div class="">재료비 : {{post.extra_price|intcomma}}
            수강료 : {{post.price|intcomma}}
            총합 : {{ post.extra_price|add:post.price |intcomma}}원
        </div>

        <a href="http://{{HTTP_HOST}}/v2.1/user/profile/{{post.user.id}}">
            <img src="{{MEDIA_URL}}{{post.user.t2profile_set.first.pro_pic}}">
            <span>클래스 선생님</span>
            {{post.user.last_name}}{{post.user.first_name}}</a>

        <!-- 결제 하기 -->
        <form method="GET" action="{% url 'pay_prefill_v2d1' %}">
            <input type="hidden" value="{{post.id}}" name="post_id">
            <input type="hidden" value="teachclass" name="classtype">
            <button class="btn btn-primary">
                신청하기 <input type="submit" value="{{ post.extra_price|add:post.price |intcomma}}원" hidden>
            </button>
        </form>
    </div>
        </div>
</div>

<div class="tmk-main-body col-md-12">
        <div class="tmk-review">
            <div class="col-md-8 col-md-offset-1">
                <h2>후기 쓰기</h2>


                <form method="POST" action="{% url 'create_review_v2d1' post.id %}">
                    {%csrf_token%}
                    <div class="col-md-8 col-xs-8">
                        <input type="hidden" name="class_num" value="{{post.id}}">
                        <input type="hidden" name="classtype" value="teach_class">
                        <textarea class="form-control" name="review"></textarea><br>
                        {{review.review.errors|striptags}}
                        <input class="form-control" type="number" name="grade"><br>
                        {{review.grade.errors|striptags}}
                    </div>
                    <div class="col-md-2 col-xs-4">
                        <input class="btn btn-primary" type="submit" value="후기 작성"></div>
                </form>
            </div>



            <div class="col-md-8 col-md-offset-1">
                {% for review in post.t2classreview_set.all%}
                {% if review.is_active %}
                <a href="http://{{HTTP_HOST}}/v2.1/user/profile/{{review.user.id}}">
                <div class="col-md-2"><img src="{{MEDIA_URL}}{{review.user.t2profile_set.first.pro_pic}}"></div>
                <div class="col-md-10">{{review.user.last_name}}{{review.user.first_name}} / 등급::{{review.grade}}<br>
                    후기::{{review.review}}
                    </div></a>
                <!--수정 form 나중에  hidden-->
            </div>

            <div class="col-md-8 col-md-offset-1">
                <form method="POST" action="{% url 'modify_review_v2d1' post.id %}">
                    {%csrf_token%}
                    <div class="col-md-8">
                        <input type="hidden" name="review_num" value="{{review.id}}">
                        <input type="hidden" name="class_num" value="{{post.id}}">
                        <input type="hidden" name="classtype" value="teach_class">
                        <textarea class="form-control" name="review">{{review.review}}</textarea><br>
                        {{review.review.errors|striptags}}
                        <input class="form-control" type="number" name="grade" value="{{review.grade}}"><br>
{{review.grade.errors|striptags}}
                    </div>
                    <div class="col-md-2">
                        <input class="btn btn-link" type="submit" value="후기수정">
                    </div>
                </form>

                <form method="POST" action="{% url 'delete_review_v2d1' review.id%}">
                    {%csrf_token%}
                    <input type="hidden" name="classtype" value="teach_class">
                    <input class="btn btn-link" type="submit" value="삭제하기">
                </form>
                {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
<!--</div>-->
<div class="tmk-main-body col-md-12" style="background:#eee;margin-top:3px;margin-bottom:-50px;padding:30px;">
    <div style="margin:50px auto;">
        <div class="tmk-h3" style="font-weight:bold;">원하는 클래스를 찾지 못했나요?</div>
        <div class="tmk-h4">클래스를 제안해보세요 원하시는 클래스를 개설해드린답니다</div>
        <a href="http://{{HTTP_HOST}}/v2.1/demand/create" class="btn btn-link" style="color:red;">클래스 제안하기 ></a>

    </div>
</div>
{%endblock%}
